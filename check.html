<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç³»çµ±ç‹€æ…‹æª¢æŸ¥</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
    .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
    .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
    .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
    .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
    button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
    .test-btn { background: #007bff; color: white; }
    .type-card { border: 2px solid #ddd; padding: 10px; margin: 5px; display: inline-block; cursor: pointer; }
    .type-card:hover { border-color: #007bff; }
  </style>
</head>
<body>
  <h1>ğŸ”§ æ™ºèƒ½æ¨è–¦ç³»çµ±ç‹€æ…‹æª¢æŸ¥</h1>
  
  <div id="status" class="status info">æ­£åœ¨æª¢æŸ¥ç³»çµ±ç‹€æ…‹...</div>
  
  <h2>ğŸ“Š åŸºæœ¬ç‹€æ…‹</h2>
  <div id="basicStatus">æª¢æŸ¥ä¸­...</div>
  
  <h2>ğŸ”— WebSocket æ¸¬è©¦</h2>
  <button class="test-btn" onclick="testWebSocket()">æ¸¬è©¦é€£æ¥</button>
  <div id="wsStatus">ç­‰å¾…æ¸¬è©¦...</div>
  
  <h2>ğŸ¯ æ¨è–¦å¡ç‰‡æ¸¬è©¦</h2>
  <div class="type-card" onclick="testRecommendation('å¥åº·æ¨è–¦')">
    <div>ğŸ¥—</div>
    <div>å¥åº·æ¨è–¦</div>
  </div>
  <div class="type-card" onclick="testRecommendation('å¿«é€Ÿæ–™ç†')">
    <div>âš¡</div>
    <div>å¿«é€Ÿæ–™ç†</div>
  </div>
  <div id="cardStatus">ç­‰å¾…æ¸¬è©¦...</div>
  
  <h2>âš¡ å¿«é€ŸæŒ‰éˆ•æ¸¬è©¦</h2>
  <button class="test-btn" onclick="testQuickRecommendation('æ—©é¤æ¨è–¦')">ğŸŒ… æ—©é¤æ¨è–¦</button>
  <button class="test-btn" onclick="testQuickRecommendation('åˆé¤æ¨è–¦')">ğŸ± åˆé¤æ¨è–¦</button>
  <div id="quickStatus">ç­‰å¾…æ¸¬è©¦...</div>
  
  <h2>ğŸ“ æ¸¬è©¦çµæœ</h2>
  <div id="testResults"></div>
  
  <div style="margin-top: 2rem;">
    <a href="/" style="display: inline-block; padding: 10px 20px; background: #6c757d; color: white; text-decoration: none; border-radius: 5px;">
      â¬…ï¸ è¿”å›ä¸»é é¢
    </a>
  </div>
  
  <script>
    let results = [];
    
    function log(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = `[${timestamp}] ${message}`;
      results.push(logEntry);
      
      const resultsDiv = document.getElementById('testResults');
      resultsDiv.innerHTML = results.slice(-10).join('<br>');
      
      console.log(logEntry);
    }
    
    function updateStatus(id, message, type = 'info') {
      const element = document.getElementById(id);
      element.innerHTML = message;
      element.className = `status ${type}`;
    }
    
    function testWebSocket() {
      log('é–‹å§‹æ¸¬è©¦ WebSocket é€£æ¥...');
      updateStatus('wsStatus', 'æ­£åœ¨é€£æ¥...', 'info');
      
      try {
        const ws = new WebSocket(`ws://${location.host}`);
        
        ws.onopen = function() {
          log('âœ… WebSocket é€£æ¥æˆåŠŸ', 'success');
          updateStatus('wsStatus', 'âœ… WebSocket é€£æ¥æˆåŠŸ', 'success');
          
          // æ¸¬è©¦ç™¼é€æ¶ˆæ¯
          ws.send(JSON.stringify({ prompt: 'æ¸¬è©¦é€£æ¥' }));
        };
        
        ws.onmessage = function(event) {
          log('ğŸ“¥ æ”¶åˆ°æœå‹™å™¨å›æ‡‰', 'success');
          updateStatus('wsStatus', 'âœ… WebSocket åŠŸèƒ½æ­£å¸¸', 'success');
          ws.close();
        };
        
        ws.onerror = function(error) {
          log('âŒ WebSocket é€£æ¥å¤±æ•—', 'error');
          updateStatus('wsStatus', 'âŒ WebSocket é€£æ¥å¤±æ•—', 'error');
        };
        
        ws.onclose = function() {
          log('ğŸ”Œ WebSocket é€£æ¥å·²é—œé–‰');
        };
        
      } catch (error) {
        log('âŒ WebSocket æ¸¬è©¦ç•°å¸¸: ' + error.message, 'error');
        updateStatus('wsStatus', 'âŒ WebSocket æ¸¬è©¦ç•°å¸¸', 'error');
      }
    }
    
    function testRecommendation(type) {
      log(`ğŸ¯ æ¸¬è©¦æ¨è–¦å¡ç‰‡: ${type}`);
      updateStatus('cardStatus', `æ¸¬è©¦ ${type} ä¸­...`, 'info');
      
      try {
        const ws = new WebSocket(`ws://${location.host}`);
        
        ws.onopen = function() {
          ws.send(JSON.stringify({ prompt: `è«‹æ¨è–¦${type}` }));
        };
        
        ws.onmessage = function(event) {
          log(`âœ… ${type} æ¨è–¦åŠŸèƒ½æ­£å¸¸`, 'success');
          updateStatus('cardStatus', `âœ… ${type} æ¨è–¦åŠŸèƒ½æ­£å¸¸`, 'success');
          ws.close();
        };
        
        ws.onerror = function() {
          log(`âŒ ${type} æ¨è–¦åŠŸèƒ½å¤±æ•—`, 'error');
          updateStatus('cardStatus', `âŒ ${type} æ¨è–¦åŠŸèƒ½å¤±æ•—`, 'error');
        };
        
      } catch (error) {
        log(`âŒ ${type} æ¸¬è©¦ç•°å¸¸: ${error.message}`, 'error');
        updateStatus('cardStatus', `âŒ ${type} æ¸¬è©¦ç•°å¸¸`, 'error');
      }
    }
    
    function testQuickRecommendation(type) {
      log(`âš¡ æ¸¬è©¦å¿«é€Ÿæ¨è–¦: ${type}`);
      updateStatus('quickStatus', `æ¸¬è©¦ ${type} ä¸­...`, 'info');
      
      try {
        const ws = new WebSocket(`ws://${location.host}`);
        
        ws.onopen = function() {
          ws.send(JSON.stringify({ prompt: `è«‹æ¨è–¦${type}` }));
        };
        
        ws.onmessage = function(event) {
          log(`âœ… ${type} åŠŸèƒ½æ­£å¸¸`, 'success');
          updateStatus('quickStatus', `âœ… ${type} åŠŸèƒ½æ­£å¸¸`, 'success');
          ws.close();
        };
        
        ws.onerror = function() {
          log(`âŒ ${type} åŠŸèƒ½å¤±æ•—`, 'error');
          updateStatus('quickStatus', `âŒ ${type} åŠŸèƒ½å¤±æ•—`, 'error');
        };
        
      } catch (error) {
        log(`âŒ ${type} æ¸¬è©¦ç•°å¸¸: ${error.message}`, 'error');
        updateStatus('quickStatus', `âŒ ${type} æ¸¬è©¦ç•°å¸¸`, 'error');
      }
    }
    
    // é é¢è¼‰å…¥æ™‚çš„åŸºæœ¬æª¢æŸ¥
    window.onload = function() {
      log('ğŸš€ æª¢æŸ¥é é¢å·²è¼‰å…¥');
      
      // åŸºæœ¬ç‹€æ…‹æª¢æŸ¥
      let statusText = '';
      statusText += `ğŸŒ URL: ${location.href}<br>`;
      statusText += `ğŸ•’ æ™‚é–“: ${new Date().toLocaleString()}<br>`;
      statusText += `ğŸ“± ç€è¦½å™¨: ${navigator.userAgent.split(' ')[0]}<br>`;
      statusText += `ğŸ”§ WebSocket æ”¯æ´: ${typeof WebSocket !== 'undefined' ? 'âœ…' : 'âŒ'}<br>`;
      
      document.getElementById('basicStatus').innerHTML = statusText;
      updateStatus('status', 'âœ… æª¢æŸ¥é é¢å·²æº–å‚™å°±ç·’', 'success');
      
      log('âœ… åŸºæœ¬æª¢æŸ¥å®Œæˆ');
    };
  </script>
</body>
</html> 